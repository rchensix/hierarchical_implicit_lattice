%% Commands for TeXCount
%TC:macro \cite [option:text,text]
%TC:macro \citep [option:text,text]
%TC:macro \citet [option:text,text]
%TC:envir table 0 1
%TC:envir table* 0 1
%TC:envir tabular [ignore] word
%TC:envir displaymath 0 word
%TC:envir math 0 word
%TC:envir comment 0 0

\documentclass[acmtog]{acmart}

%% Rights management information.  This information is sent to you
%% when you complete the rights form.  These commands have SAMPLE
%% values in them; it is your responsibility as an author to replace
%% the commands and values with those provided to you when you
%% complete the rights form.
\setcopyright{acmcopyright}
\copyrightyear{2025}
\acmYear{2025}
\acmDOI{XXXXXXX.XXXXXXX}


%%
%% These commands are for a JOURNAL article.
\acmJournal{TOG}
\acmVolume{37}
\acmNumber{4}
\acmArticle{111}
\acmMonth{8}

%%
%% Submission ID.
%% Use this when submitting an article to a sponsored event. You'll
%% receive a unique submission ID from the organizers
%% of the event, and this ID should be used as the parameter to this command.
%%\acmSubmissionID{123-A56-BU3}

%%
%% For managing citations, it is recommended to use bibliography
%% files in BibTeX format.
%%
%% You can then either use BibTeX with the ACM-Reference-Format style,
%% or BibLaTeX with the acmnumeric or acmauthoryear sytles, that include
%% support for advanced citation of software artefact from the
%% biblatex-software package, also separately available on CTAN.
%%
%% Look at the sample-*-biblatex.tex files for templates showcasing
%% the biblatex styles.
%%

%%
%% The majority of ACM publications use numbered citations and
%% references.  The command \citestyle{authoryear} switches to the
%% "author year" style.
%%
%% If you are preparing content for an event
%% sponsored by ACM SIGGRAPH, you must use the "author year" style of
%% citations and references.
\citestyle{acmauthoryear}


%%
%% end of the preamble, start of the body of the document source.
\begin{document}

%%
%% The "title" command has an optional parameter,
%% allowing the author to define a "short title" to be used in page headers.
\title{Symmetric Implicit Surface Microstructures for Hierarchical Design}

%%
%% The "author" command and its associated commands are used to define
%% the authors and their affiliations.
%% Of note is the shared affiliation of the first two authors, and the
%% "authornote" and "authornotemark" commands
%% used to denote shared contribution to the research.
\author{Ruiqi Chen}
\email{rchensix@alumni.stanford.edu}
\orcid{0002-5273-6277}
\author{Hardik Kabaria}
\email{hardikk@alumni.stanford.edu}
\orcid{0000-0000-0000}
\author{Adrian J. Lew}
\email{lewa@stanford.edu}
\orcid{0000-0002-1559-7087}
\affiliation{
  \institution{Stanford University}
  \streetaddress{440 Escondido Mall}
  \city{Stanford}
  \state{California}
  \country{USA}
  \postcode{94305}
}

%%
%% By default, the full list of authors will be used in the page
%% headers. Often, this list is too long, and will overlap
%% other information printed in the page headers. This command allows
%% the author to define a more concise list
%% of authors' names for this purpose.
\renewcommand{\shortauthors}{Chen et al.}

%%
%% The abstract is a short summary of the work to be presented in the
%% article.
\begin{abstract}
  We present a framework for generating hierarchical structures using a palette of symmetric implicit surface microstructures. The framework utilizes an unstructured mesh composed solely of triangles, quadrilaterals, tetrahedrons, or hexahedrons to serve as a scaffold for microstructural unit cells to tile, where each unit cell is represented by an implicit surface and defined using a set of symmetric basis functions derived from Fourier series. Any arbitrary unit cell may be converted into a symmetric implicit surface using an Fast-Fourier-Transform-based method as long as containment queries (i.e. inside or outside) can be performed on the unit cell. Using our framework, we demonstrate blending together different unit cells to create new ones as well as spatial transitions between different unit cells. In addition, we present a method to constrain unit cells to intersect its bounding polygon/polyhedron at a right angle, which we postulate is necessary for $C^1$ continuity. Finally, we briefly mention some mechanical applications that may benefit from our framework.
\end{abstract}

%%
%% The code below is generated by the tool at http://dl.acm.org/ccs.cfm.
%% Please copy and paste the code instead of the example below.
%%
\begin{CCSXML}
<ccs2012>
    <concept>
        <concept_id>10010405.10010432.10010439.10010440</concept_id>
        <concept_desc>Applied computing~Computer-aided design</concept_desc>
        <concept_significance>500</concept_significance>
        </concept>
    <concept>
        <concept_id>10010405.10010432.10010433</concept_id>
        <concept_desc>Applied computing~Aerospace</concept_desc>
        <concept_significance>100</concept_significance>
        </concept>
    <concept>
        <concept_id>10010147.10010371.10010396</concept_id>
        <concept_desc>Computing methodologies~Shape modeling</concept_desc>
        <concept_significance>500</concept_significance>
        </concept>
  </ccs2012>
\end{CCSXML}

\ccsdesc[500]{Applied computing~Computer-aided design}
\ccsdesc[100]{Applied computing~Aerospace}
\ccsdesc[500]{Computing methodologies~Shape modeling}

%%
%% Keywords. The author(s) should pick words that accurately describe
%% the work being presented. Separate the keywords with commas.
\keywords{hierarchical structure, implicit surface, lattice, microstructure, symmetry}

\received{DD MONTH YYYY}
\received[revised]{DD MONTH YYYY}
\received[accepted]{DD MONTH YYYY}

%%
%% This command processes the author and affiliation and title
%% information and builds the first part of the formatted document.
\maketitle

\section{Introduction}

\subsection{Contributions}
To the best of our knowledge, this work is the first to present a framework for generating hierarchical structures using \textit{unstructured} scaffold meshes composed solely of one element type: triangles, quadrilaterals, tetrahedrons, and hexahedrons. Furthermore, this work is the first to present a method of transitioning between arbitrarily chosen unit cells within the unstructured scaffold mesh. By supporting the most common unstructured mesh types, we ensure that our framework is compatible with a wide range of off-the-shelf mesh generators and can be used to generate hierarchical structures from complex design domains that are practically unsuitable for structured meshing.

In short, this paper makes the following contributions:
% TODO(rchensix): Add more contributions
\begin{itemize}
  \item We develop a novel method to construct hierarchical structures from an unstructured mesh scaffold comprised solely of triangles, quadrilaterals, tetrahedrons, or hexahedrons.
  \item Our method allows for multiple cell types to be prescribed, enabling spatially varying hierarchical structures.
  \item We enable constraining the unit cell to intersect its bounding polygon/polyhedron at a right angle by solving a constrained least squares problem.
\end{itemize}

\section{Related Works}

\section{Methodology}

\subsection{Symmetric Implicit Surfaces}
\label{sec:symmetric_implicit_surfaces}

Implicit surfaces represent a geometric object through an equation of the form $\Phi(\mathbf{x}) = 0$ where $\Phi: \mathbb{R}^d \rightarrow \mathbb{R}$ is some function that evaluates a query point $\mathbf{x} \in \mathbb{R}^d$ and returns zero if $\mathbf{x}$ is on the surface, returns a negative value if $\mathbf{x}$ is inside the surface, or returns a positive value if $\mathbf{x}$ is outside the surface (note that this convention is not universal and some authors use the opposite convention). In this work, we are interested in implicit surface functions that represent 2D and 3D geometries, so we assume that $d = 2$ or $d = 3$. The magnitude of the return value of the implicit surface function may have some geometric meaning, but this is not required. For example, signed distance functions (SDFs) are a subset of implicit surface equations where the magnitude of the return value denotes the distance from $\mathbf{x}$ to the surface.

A symmetric implicit surface is defined in this work to be an implicit surface equation that is invariant under transformations from a chosen point group $\mathcal{S}$. In other words, $\Phi(\mathbf{x}) = \Phi(\mathbf{Q} \mathbf{x})$, where $\mathbf{Q}: \mathbb{R}^{d \times d} \in \mathcal{S}$ is an orthonormal matrix that represents an isometry (i.e. rotation, reflection, inversion, or rotoinversion of a point $\mathbf{x}$ about the origin). To construct an implicit surface suitable for generating hierarhical structures, we want to constrain the implicit surface to match the point group of the cell type in the unstructured scaffold mesh to tile: dihedral group of degree 3 and order 6 ($D_3$) for triangle meshes, dihedral group of degree 4 and order 8 ($D_4$) for quadrilateral meshes, achiral tetrahedral symmetry ($T_d$) for tetrahedron meshes, and achiral octahedral symmetry ($O_h$) for hexahedron meshes. The list of symmetry operators for these four symmetry groups is given in Appendix \ref{sec:symmetry_groups}. The necessity of symmetric implicit surfaces to tile the unstructured scaffold mesh is explained in detail in Section \ref{sec:tiling_mesh_scaffolds}, but in brief, it is the symmetry that ensures $C^0$ continuity at the boundaries of the hierarchical structure. Furthermore, symmetry is crucial for enabling the spatial transitions described in Section \ref{sec:spatial_transitions}.

To construct a symmetric implicit surface $\Phi(\mathbf{x})$, we first construct a symmetric orthonormal basis function $\phi(\mathbf{x}): \mathbb{R}^d \rightarrow \mathbb{R}$. The symmetric basis function is constructed from some other conventional (i.e. non-symmetric) orthonormal basis function $\psi(\mathbf{x}): \mathbb{R}^d \rightarrow \mathbb{R}$ by iterating over the symmetry operators $\mathbf{Q}$ and summing together $\psi$ composed with the linear transformation of $\mathbf{x}$ by $\mathbf{Q}$:
%
\begin{equation}
  \label{eq:basis_function}
  \phi(\mathbf{x}) = K \sum\limits_{\mathbf{Q} \in \mathcal{S}} \psi(\mathbf{Qx})
\end{equation}
%
where $K$ is a normalization factor to make the basis function orthonormal. In this work, the $d$-dimensional Fourier series
%
\begin{equation}
  \label{eq:fourier_series}
  \psi_{\mathbf{f}}(\mathbf{x}) = e^{2\pi i \mathbf{f}^T \mathbf{x}}
\end{equation}
%
is used, where $\mathbf{f}: \mathbb{R}^d \in \mathcal{F}$ is an integer-valued vector that represents spatial frequencies in the Cartesian directions, and $\mathcal{F} \subset \mathbb{Z}^d$ is a subset of the $d$-dimensional integer lattice that is specific to the chosen scaffold mesh type. In other words, $\mathcal{F}$ contains all of the \textit{unique} spatial frequencies that may be used to construct a symmetric basis functions. Any spatial frequencies not in $\mathcal{F}$ do not need to be considered due to symmetry. For example, suppose the scaffold mesh is a quadrilateral mesh, then one representation for $\mathcal{F}$ is given by
%
\begin{equation}
  \mathcal{F} = \left\{ (f_x, f_y) \in \mathbb{Z}^2 | f_y \geq 0 \: \text{and} \: f_x - f_y \geq 0 \right\}
\end{equation}
%
This representation of $\mathcal{F}$ for a quadrilateral mesh is depicted in Figure \ref{fig:unique_freqs_quad}(a).
%
\begin{figure}
  \centering
  \includegraphics[width=0.45\textwidth]{figures/quad_z_lattice_points.pdf}
  \caption{A subset $\mathcal{F}$ of the $\mathbb{Z}^2$ lattice defines unique spatial frequencies that can be used to generate unit cells with $D_4$ symmetry. Both (a) and (b) are valid representations for $\mathcal{F}$, and it is a matter of user preference to choose.}
  \label{fig:unique_freqs_quad}
\end{figure}
%
Note that if all of the symmetry operators in $S$ are applied to $\mathcal{F}$, then we would recover $\mathbb{Z}^2$. Also note that the representation of $\mathcal{F}$ is not unique; Figure \ref{fig:unique_freqs_quad}(b) shows an alternative representation that is equally valid. Representations of $\mathcal{F}$ used in this work for triangles, quadrilaterals, tetrahedrons, and hexahedrons are given in Appendix \ref{sec:symmetry_groups}. Additionally, note that by writing the Fourier series using complex exponentials (as expressed in Equation \ref{eq:fourier_series}), Equation \ref{eq:basis_function} is, in general, a function that takes in real-valued $d$-D points and returns complex valued scalars, i.e. $\phi_{\mathbf{f}}(\mathbf{x}): \mathbb{R}^d \rightarrow \mathbb{C}$. However, for the purpose of generating implicit surfaces, only the real or imaginary part (but not both) of the final expression for $\Phi(\mathbf{x})$ will be used.

There are many reasons, both mathematical and practical, as to why the Fourier series is an excellent choice for the foundational basis function, but the primary reasons are: Fourier series are an orthonormal basis, Fourier series have a very simple expression for the gradient (this is used in Section \ref{sec:face_normal_surfaces}); there are fast, robust algorithms available--most notably, the fast Fourier transform (FFT)--for computing the cofficients of a Fourier expansion; and finally, several famous triply periodic minimal surfaces (TPMS) commonly used to construct hierarchical lattice structures (e.g. Schwarz primitive, gyroid) may be approximated using Fourier series \cite{wohlgemuth2001triply}.

Substituting Equation \ref{eq:fourier_series} into Equation \ref{eq:basis_function}, the symmetric basis function may be expressed as
%
\begin{equation}
  \label{eq:basis_function_actual}
  \phi_{\mathbf{f}}(\mathbf{x}) = K_{\mathbf{f}} \sum\limits_{\mathbf{Q} \in \mathcal{S}} e^{2 \pi i \mathbf{f}^T \mathbf{Q} \mathbf{x}}
\end{equation}
%
where $K_{\mathbf{f}}$ is the normalization factor given by
\begin{equation}
  \label{eq:normalization_coeff}
  K_{\mathbf{f}} = \left( \int_{\Omega}{ \sum\limits_{\mathbf{Q_1}, \mathbf{Q_2} \in \mathcal{S}} e^{2 \pi i \mathbf{f}^T (\mathbf{Q_1 - Q_2}) \mathbf{x}} d\mathbf{x} } \right)^{-1/2}
\end{equation}
In the integrand in the denominator of Equation \ref{eq:normalization_coeff}, due to the orthonormal property of Fourier series, only terms where $\mathbf{f}^T \left( \mathbf{Q_1} - \mathbf{Q_2} \right) = \mathbf{0}$ contribute to the integral.

Just like the Fourier series, the resulting basis function in Equation \ref{eq:basis_function_actual} is orthonormal, i.e.
%
\begin{equation}
  \begin{split}
    \int_{\Omega} \phi_{\mathbf{f}}(\mathbf{x}) \overline{\phi_{\mathbf{g}}(\mathbf{x})} d\mathbf{x} = 0 \\
    %
    \int_{\Omega} \phi_{\mathbf{f}}(\mathbf{x}) \overline{\phi_{\mathbf{f}}(\mathbf{x})} d\mathbf{x} = 1 \\
  \end{split}
\end{equation}
%
for some $\mathbf{f}, \mathbf{g} \in \mathcal{F}$ and $\mathbf{f} \neq \mathbf{g}$. The symmetric implicit surface $\Phi(\mathbf{x})$ may now be expressed in terms of a sum of the basis functions:
%
\begin{equation}
  \label{eq:symmetric_implicit_surface}
  \Phi(\mathbf{x}) = \sum\limits_{\mathbf{f} \in \mathcal{F}} c_{\mathbf{f}} \phi_{\mathbf{f}}(\mathbf{x})
\end{equation}
%
where $c_{\mathbf{f}}$ are the weight coefficients for each basis function.

Given an arbitrary input implicit surface $g(\mathbf{x}): \mathbb{R}^d \rightarrow \mathbb{R}$, which may or may not be symmetric, a symmetric approximation to $g(\mathbf{x})$ may be computed by projecting $g(\mathbf{x})$ onto the basis functions to recover the weight coefficients:
%
\begin{equation}
  \label{eq:weight_coeffs}
  c_{\mathbf{f}} = \int_{\Omega} g(\mathbf{x}) \phi_{\mathbf{f}}(\mathbf{x}) dV
\end{equation}
%
In this case, because the input function $g(\mathbf{x})$ is real-valued, the output function $\Phi(\mathbf{x})$ will also be real-valued. In practice, Equation \ref{eq:weight_coeffs} will be evaluated numerically, and the unit cell to approximate does not have to be an implicit surface equation, as demonstrated in Section \ref{sec:converting_geometry}.

\subsubsection{Choice of $\Omega$}

Before proceeding, we need to clarify what the domain $\Omega$ is. Recall that the goal of defining these symmetric orthonormal basis functions is to use them to approximate an input unit cell. Thus, $\Omega$ should be a (non-strict) superset of the domain of the unit cell. However, $\Omega$ should also ideally be carefully chosen such that the $d$-dimensional Fourier series is an orthonormal basis in $\Omega$; while this is not strictly necessary for the purposes of approximating the unit cell, it greatly simplifies things and enables us to utilize efficient algorithms such as the FFT and existing software packages (e.g. numpy.fft \cite{harris2020array} and scipy.fft \cite{virtanen2020scipy}) to compute the approximation. For unit cells defined in the square or cube, the choice of $\Omega$ is trivial: $\Omega$ will be the square or cube, respectively. For unit cells defined in the regular triangle or tetrahedron, we choose $\Omega$ to be an \textit{extended domain} that is a superset of the regular triangle or tetrahedron, and which the Fourier series is orthonormal.

\subsubsection{Extended Domain for Triangle and Tetrahedron}

For a regular triangle, $\Omega$ is chosen to be a rhombus with $60^\circ$ and $120^\circ$ interior angles (i.e. the union of two regular triangles). In addition, a skew coordinate system where $\mathbf{x_1}$ and $\mathbf{x_2}$ are $60^\circ$ apart is used so that the Fourier series expressed in this skew coordinate system is orthogonal. Note that we can easily make the Fourier series orthonormal in $\Omega$ by scaling by the square root of the Jacobian determinant:
\begin{equation}
  \sqrt{
    \begin{vmatrix}
      \mathbf{x_1} & \mathbf{x_2} \\
    \end{vmatrix}
  } = \sqrt{
    \begin{vmatrix}
      1 & \cos(60^{\circ}) \\
      0 & \sin(60^{\circ}) \\
    \end{vmatrix}
  } = \sqrt{\frac{2}{\sqrt{3}}}
\end{equation}
A regular triangle, its extended domain $\Omega$, and the skew coordinate system are depicted in Figure \ref{fig:triangle_extended_domain_skew_coordinates}.
%
\begin{figure}
  \centering
  \includegraphics[width=0.45\textwidth]{figures/triangle_extended_domain.pdf}
  \caption{A regular triangle (grey), its extended domain $\Omega$ (black outline), and skew coordinate system defined by directions $x_1$ and $x_2$.}
  \label{fig:triangle_extended_domain_skew_coordinates}
\end{figure}
%
For a regular tetrahedron, $\Omega$ is chosen to be the unit cube because, intuitively, both the cube and tetrahedron have $T_d$ symmetry (i.e. $T_d$ is a subgroup of $O_h$). A regular tetrahedron and its extended domain $\Omega$ are depicted in Figure \ref{fig:tetrahedron_extended_domain}.

In addition to defining the extended domains, we also have to define how to extend the original unit cell into the extended domains. In this work, we extend the unit cell geometry by mirroring the unit cell about the edges (faces) of the triangle (tetrahedron) until the entire extended domain is populated. This space-filling process intuitively mimics how hierarchical structures are constructed from a unit cell. Without this step, the approximate implicit surface geometries may "disappear" at the boundaries of the original unit cell. We note that the extended domains and methods of extending the original unit cell we have chosen are not unique.

In addition, it is worth stepping back to understand \textit{why} we choose to use the method of extended domains rather than, say, some other orthonormal basis function that is orthonormal in the \textit{original} unit cell domain. The main reason is due to practicality: we want to use the Fourier series as our starting basis function to take advantage of the FFT algorithm and existing software libraries. If we were to use some other orthonormal basis, we would first have to \textit{find} some other orthonormal basis (via Gram-Schmidt or similar algorithms), then numerically evaluate the integrals to compute the coefficients for approximating the unit cell. While all this is technically feasible, we suspect there may be some challenges with numerical stability and computational efficiency. Thus, we choose to use the method of extended domains in this paper instead.

\subsection{Converting Geometry Representations to Implicit Surfaces}
\label{sec:converting_geometry}

Frequently, a user will choose a unit cell based on some criteria (e.g. aesthetics, porosity, mechanical performance, etc.) to create the hierarchical structure. The unit cell to tile may not be an implicit surface; furthermore, it may not have \textit{any} symmetry either. To accomodate nearly arbitrary incoming geometry representations (e.g. triangle meshes, NURBS, voxel grids), the only requirement is that the input representation has a method to determine whether a query point is inside or outside the geometry. For example, containment queries on oriented point clouds and triangle meshes/soups can be computed extremely robustly using the fast winding number method \cite{barill2018fast}. However, practically speaking, better results are obtained if the input representation has a method to query the signed distance instead of just the containment because a signed distance query will generally be smoother than a binary containment query, which helps reduce artifacts associated with the Gibbs phenomenon. In addition, if the unit cell is not symmetric, a preprocessing step to force the unit cell to be symmetric may yield better results. This forced symmetricization may be performed using various methods and the methods will depend on the input unit cell representation. For example, if the unit cell is a triangle mesh, then one may apply the transformations from $\mathcal{S}$ onto copies of the unit cell and union together the transformed copies. Note that this forced symmetricization preprocessing step is not necessary--fitting an implicit surface approximation using symmetric basis functions to a non-symmetric input unit cell will still yield a symmetric result--however, the results may be better and helps avoid cases where the implicit surface approximation "disappears". Finally, for triangle and tetrahedron based unit cells, the unit cell should be extended into $\Omega$.

To numerically compute the implicit surface approximation $\Phi(\mathbf{x})$, first, the (extended) unit cell is positioned such that it is fully contained by $\Omega$. The unit cell is then sampled by querying the containment status (or, better yet, the signed distance) on an $N^d$ grid of equispaced query points to yield a sampling of $g(\mathbf{x})$. Next, the fast Fourier transform (FFT) is applied to the sampling of $g(\mathbf{x})$. Finally, the weight coefficients $c_{\mathbf{f}}$ are computed from the FFT result by noting that the right hand side of Equation \ref{eq:weight_coeffs} is simply a summation of FFT coefficients due to the fact that $\phi_{\mathbf{f}}(\mathbf{x})$ is itself a summation of 3D complex exponentials.

TODO: give an example? Or an algorithm?

It is worth noting that if the input geometry is band limited (i.e. the input geometry is generated from a 3D Fourier series implicit equation with a finite set of spatial frequencies), then using the FFT to compute the weight coefficients $c_{\mathbf{f}}$ will be exact up to limitations in floating point computations, as long as $N$ is large enough to satisfy the Nyquist-Shannon sampling theorem, i.e. $h < \frac{N}{2}$ where $h \in \mathbb{Z}$ is the maximum magnitude integer frequency in any basis direction of the input geometry. However, if the input geometry is not band limited (e.g. there are sharp edges and corners), then this method will only yield approximate values of $c_{\mathbf{f}}$ due to aliasing. In practice, given some arbitrary input geometry that may or may not be band limited, one can choose some reasonable starting value for $N$ such that the FFT can compute relatively quickly (for example $N = 2^7$), compute the implicit surface approximation to the input, and use some stopping criteria to determine if $N$ is large enough. One example of stopping criteria is the Hausdorff distance between the input geometry and output approximation. Furthermore, choosing powers of two for values of $N$ is practical due to exploiting efficiencies in the FFT algorithm. The topic of convergence of the Fourier series is well studied in literature. Since the main purpose of this paper is to develop methods to generate hierarchical structures, i.e. the main purpose is \textit{not} about the convergence of Fourier series, most examples in this paper will use some "large-enough", arbitrarily chosen value for $N$.

As previously mentioned, better results are achieved if the signed distance of the unit cell is used instead of the binary containment query. Another reason to use the signed distance is because the implicit surface approximation is effectively an approximation of the signed distance function of the unit cell, which means performing certain downstream unit cell modifications such as erosion and dilation is trivial. This is incredibly important and useful for generating hierarchical structures with spatially varying thicknesses, as depicted in Section TODO.

\subsection{Face Normal Surfaces}
\label{sec:face_normal_surfaces}

In addition to symmetry constraints, the implicit surface unit cell can be further constrained to intersect with its bounding polygon/polyhedron at a right angle. We postulate this is an important property to have in order to generate hierarchical structures with $C^1$ continuity in higher order meshes with $C^1$ continuity constraints applied to control points (see Section \ref{sec:higher_order_scaffolds}). To apply this face normal constraint, we first note that the outward normal vector of an implicit surface is given by its gradient:
%
\begin{equation}
  \mathbf{N}(\mathbf{x}) = \nabla \Phi(\mathbf{x})
\end{equation}
%
To constrain the implicit surface to intersect its bounding polygon/polyhedron at a right angle, we need its outward normal to be at a right angle to the outward normal $\mathbf{N}_p$ of the polygon/polyhedron face. Thus, the dot product between these two vectors must be zero when evaluated on the polygon/polyhedron faces:
%
\begin{equation}
  \label{eq:face_normal_constraint}
  \nabla \Phi(\mathbf{x}) \cdot \mathbf{N}_p \rvert \mathbf{x} \rightarrow \mathbf{x}_p = 0
\end{equation}
%
where $\mathbf{x}_p$ is a point on the bounding polygon/polyhedron face. Note that due to the symmetry constraint already imposed from our usage of symmetric basis functions, we only need to satisfy Equation \ref{eq:face_normal_constraint} on one face of the bounding polygon/polyhedron, as it will be automatically applied to the other faces. We can rewrite $\mathbf{x}_p$ as
%
\begin{equation}
  \label{eq:face_projection}
  \mathbf{x}_p = \mathbf{A} \mathbf{x} + \mathbf{b}
\end{equation}
%
where $\mathbf{A} : \mathbb{R}^{d \times d}$ is a projection matrix and $\mathbf{b} : \mathbb{R}^d $ is an offset term. Equation \ref{eq:face_projection} can be geometrically interpreted as projecting a point $\mathbf{x}$ onto the extended plane of the chosen face of the bounding polygon/polyhedron. Using Equation \ref{eq:basis_function_actual} and \ref{eq:symmetric_implicit_surface}, the gradient term can be written as:
%
\begin{equation}
  \begin{split}
    \nabla \Phi(\mathbf{x}) &= \sum\limits_{\mathbf{f} \in \mathcal{F}} c_{\mathbf{f}} \nabla \phi_{\mathbf{f}}(\mathbf{x}) \\
    %
    &= 2 \pi i \sum\limits_{\mathbf{f} \in \mathcal{F}} c_{\mathbf{f}} K_{\mathbf{f}} \sum\limits_{\mathbf{Q} \in \mathcal{S}} \mathbf{Q}^T \mathbf{f} e^{2 \pi i \mathbf{f}^T \mathbf{Q} \mathbf{x}}
  \end{split}
\end{equation}
%

\subsection{Tiling Mesh Scaffolds}
\label{sec:tiling_mesh_scaffolds}

\subsubsection{Higher Order Mesh Scaffolds}
\label{sec:higher_order_scaffolds}

\subsection{Dilation, Erosion, and Inversion}
\label{sec:dilation_erosion_inversion}

Dilating, eroding, and inverting the implicit surface unit cell is trivial.

\subsection{Hybridization}

\subsubsection{Weighted Averaging}

\subsubsection{Minkowski Sum and Difference}

\subsection{Spatial Transitions}
\label{sec:spatial_transitions}

\subsection{Generalizing to Other Symmetry Groups}

\section{Discussion}
\subsection{Limitations}
TODO continuity of implicit surface equations, enforcing continuity, etc.

TODO continuity of hybridization and transitions, how to pick transition path to enforce continuity, etc.

\subsection{Future Work}
TODO optimizing weight coefficients to achieve some target, i.e. porosity, stiffness, etc.

\section{Conclusion}

A publically available implementation of this work is available at \url{https://github.com/rchensix/tetrahedral_implicit_lattice} under an MIT License. However, please note that while the implementation itself falls under an MIT License, methods and ideas mentioned in this paper are, at the time of writing, under consideration for a patent \cite{chen2022systems}.

%%
%% The acknowledgments section is defined using the "acks" environment
%% (and NOT an unnumbered section). This ensures the proper
%% identification of the section in the article metadata, and the
%% consistent spelling of the heading.
\begin{acks}
TODO
\end{acks}

%%
%% The next two lines define the bibliography style to be used, and
%% the bibliography file.
\bibliographystyle{ACM-Reference-Format}
\bibliography{references}

\appendix

\section{Symmetry Groups}
\label{sec:symmetry_groups}
All symmetry operators here are written in crystallographic notation, composed of a $d$-tuple representing the result of applying a linear transformation to a point $\mathbf{x} \in \mathbb{R}^d$ (affine symmetry operators are not used in this work). An overbar denotes negation. For example, $x, \overline{z}, y$ represents the linear transformation
\begin{equation}
  \begin{bmatrix}
    1 & 0 & 0 \\
    0 & 0 & -1 \\
    0 & 1 & 0 \\
  \end{bmatrix}
  \begin{bmatrix}
    x \\
    y \\
    z \\
  \end{bmatrix}
  =
  \begin{bmatrix}
    x \\
    -z \\
    y \\
  \end{bmatrix}
\end{equation}
An authoritative source enumerating all space groups is the International Tables of Crystallography \cite{aroyo2016}.

\subsection{Dihedral Group of Degree 3 and Order 6}
The dihedral group of degree 3 and order 6 ($D_3$) is the symmetry group of an equilateral triangle.

\subsection{Dihedral Group of Degree 4 and Order 8}
The dihedral group of degree 4 and order 8 ($D_4$) is the symmetry group of a square.

\subsection{Achiral Tetrahedral Symmetry}
Achiral tetrahedral symmetry ($T_d$) is the symmetry group of a regular tetrahedron.

\begin{equation}
  \mathcal{F} = \left\{ \begin{bmatrix} f_x \\ f_y \\ f_z \end{bmatrix} \in \mathbb{Z}^3 | f_y + f_z \geq 0 \: \text{and} f_y - f_z \geq 0 \: \text{and} f_x - f_y \geq 0 \right\}
\end{equation}

\subsection{Achiral Octahedral Symmetry}
Achiral tetrahedral symmetry ($O_h$) is the symmetry group of a cube (as well as that of a regular octahedron, hence the name). There are 48 symmetry operators.
\begin{equation}
  \begin{split}
    x, y, z \\
    x, \overline{y}, \overline{z} \\
  \end{split}
\end{equation}

\end{document}
\endinput
